# onebitbt
Bluetooth PHY based on one-bit input and output

# System Diagram
```
                x     x
                 x   x
                  x x
                   │
                   │  Antenna
                   │
                   │
                   │
                   │
           Open    │
             │     │
        ┌────┴─────┴──────┐
        │   RX_N  RX_P    │
        │                 │
        │    SERDES RX    │
        │    @ 5 GSPS     │
        │                 │
        │       OUT       │
        └────────┬────────┘
                 │ 20bits wide at 250MHz
     ┌───────────┤
     │           │        Summing Mixer @ 2.40175 GHz
     │  ┌────────┼───────────────────────────────────┐
     │  │        │                                   │
     │  │        └────────┬────────┐                 │
     │  │                 │        │                 │
     │  │                 │        │                 │
     │  │   ┌──────┐      │        │      ┌──────┐   │
     │  │   │      │    ┌─┴┐      ┌┴─┐    │      │   │
     │  │   │  ~   ├────┤X │      │X ├────┤  ~   │   │
     │  │   │      │    └─┬┘      └┬─┘    │      │   │
     │  │   └──────┘      │        │      └──────┘   │
     │  │  One Bit        │        │     One Bit     │
     │  │  Oscillator     │        │     Oscillator  │
     │  │  0deg phase     │I      Q│     90deg phase │
     │  │            ┌────┘        └─────┐           │
     │  │      ┌─────┤                   ├─────┐     │
     │  │      │ +   │   Running adders  │ +   │     │
     │  │      │     │◄──of last 4    ──►│     │     │
     │  │      └──┬──┘   samples         └──┬──┘     │
     │  │         │                         │        │
     │  └─────────┼─────────────────────────┼────────┘
     │            │                         │
     │            │                         └─────────────┐
     │            │                                       │
     │            └─────────────────────────────────────┐ │
     │                                                  │ │
     └───────────┐                                      │ │
                 │                                      │ │
                 │        Summing Mixer @ 2.40225 GHz   │ │
        ┌────────┼───────────────────────────────────┐  │ │
        │        │                                   │  │ │
        │        └────────┬────────┐                 │  │ │
        │                 │        │                 │  │ │
        │                 │        │                 │  │ │
        │   ┌──────┐      │        │      ┌──────┐   │  │ │
        │   │      │    ┌─┴┐      ┌┴─┐    │      │   │  │ │
        │   │  ~   ├────┤X │      │X ├────┤  ~   │   │  │ │
        │   │      │    └─┬┘      └┬─┘    │      │   │  │ │
        │   └──────┘      │        │      └──────┘   │  │ │
        │  One Bit        │        │     One Bit     │  │ │
        │  Oscillator     │        │     Oscillator  │  │ │
        │  0deg phase     │I      Q│     90deg phase │  │ │
        │            ┌────┘        └─────┐           │  │ │
        │      ┌─────┤                   ├─────┐     │  │ │
        │      │ +   │   Running adders  │ +   │     │  │ │
        │      │     │◄──of last 4    ──►│     │     │  │ │
        │      └──┬──┘   samples         └──┬──┘     │  │ │
        │         │                         │        │  │ │
        └─────────┼─────────────────────────┼────────┘  │ │
                  │                         │           │ │
              ┌───┘   ┌─────────────────────┘           │ │
              │       │                  ┌──────────────┘ │
              │       │                  │                │
              │       |   @ 62.5MHz      │      ┌─────────┘
              │       │                  │      │
           ┌──┴─┐  ┌──┴─┐ 64 sample   ┌──┴─┐  ┌─┴──┐
           │ +  │  │ +  │ wide boxcar │ +  │  │ +  │
           │    │  │    │ filters     │    │  │    │
           └──┬─┘  └──┬─┘             └──┬─┘  └─┬──┘
              │       │                  │      │
              │       │                  │      │
              └┐    ┌─┘                  └┐    ┌┘
               │    │                     │    │
             ┌─┴────┴─┐                 ┌─┴────┴─┐
             │        │                 │        │
             │        │  Magnitude      │        │
             │  |s|   │  Approximators  │   |s|  │
             │        │                 │        │
             └───┬────┘                 └───┬────┘
                 └────────────┐  ┌──────────┘
                              │  │
                            ┌─┴──┴─┐
                            │      │
                            │  <   │  Comparator
                            │      │
                            └──┬───┘
                               │
                               │
                               │    Packet State Machine
           ┌───────────────────┼─────────────────┐
           │                   │                 │
           │                ┌──┴──┐              │
           │    Preamble    │     │              │
           │    Matching &  │  =  │              │
           │    Symbol Sync │     │              │
           │                └──┬──┘              │
           │                   │@1MHz            │
           │                ┌──┴──┐              │
           │    Dewhitening │     │              │
           │    LFSR        │  ^  │              │
           │                │     │              │
           │                └──┬──┘              │
           │       ┌─────┐     │    ┌─────┐      │
           │       │     ├─────┴────┤     │      │
           │       │CRC  │          │BRAM │      │
           │       │     │          │     │      │
           │       └─────┘          └──┬──┘      │
           │                           │         │
           └───────────────────────────┼─────────┘
                                       │
                                   ┌───┴────┐
                                   │        │
                                   │ UART   │
                                   │        │
                                   └───┬────┘
                                       │
                                       │

                                    Output
```
